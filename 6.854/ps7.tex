\documentclass[psamsfonts]{amsart}

%-------Packages---------
\usepackage{amssymb,amsfonts}
\usepackage[all,arc]{xy}
\usepackage{enumerate}
\usepackage[margin=1in]{geometry}
\usepackage{amsthm}
\usepackage{theorem}
\usepackage{verbatim}
\usepackage{framed}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows}

\newenvironment{sol}{\vspace{0.25cm}{\large \bfseries Solution:}}{\qedsymbol}
\newenvironment{prob}[1]{\begin{framed}{\large \bfseries Problem #1:}}{\end{framed}}
\newcommand{\makenewtitle}{
    \begin{center}
    {\huge \bfseries 6.854 Advanced Algorithms} \\
    Problem Set 7\\
    \vspace{0.25cm}
    {\bfseries John Wang} \\
    Collaborators: 
    \end{center}
    \vspace{0.5cm}
}


\bibliographystyle{plain}

\voffset = -10pt
\headheight = 0pt
\topmargin = -20pt
\textheight = 690pt

\begin{document}

\makenewtitle

\begin{prob}{1}
Another way to formulate the maximum-flow problem as a linear program is via flow decomposition. Suppose we consider all $s-t$ paths $P$ in the network $G$ and let $f_P$ be the amount of flow on path $P$. Then maximum flow says to find $z = \max \sum f_P$ subject to $\sum_{P \ni e} f_P \leq u_e$ for all edges $e$ and $f_P \geq 0$ for all paths $P$. Take the dual of this LP and give an English explanation of the objective and constraints.
\end{prob}

\begin{sol}
To take the dual of this problem, we must find corresponding variables for each of the constraints. Let $y_{e}$ be the variables in the dual corresponding to the constraints $\sum_{P \ni e} f_P \leq u_e$ (one for each edge $e$). By formulating the dual's matrix, we see that the objective function for the dual becomes $min \sum_{e} u_e y_e$. 

Using the coefficients on the objective from the primal, we can find some of the constraints for the dual. Namely, we know that $y_e \geq 0$. Moreover, we find the condition $\sum_{e \in P} y_e \geq 1$ for all paths $P$ because of the objective function in the primal. Therefore, we have the following linear program:

\begin{eqnarray}
\min \sum_e u_e y_e \\
\text{s.t.} \hspace{1cm} \sum_{e \in P} y_e \geq 1 \\
y_e \geq 0
\end{eqnarray}

We can think of $y_e$ as the length of each edge. Thus, the two constraints say that the total distance from $s$ to $t$ using the edges must be positive. The second constraint, $y_e \geq 0$ says that edge lengths must be greater than 0. If we use this interpretation to interpret the objective, we find that we are attempting to minimize the sum of the length times the capacity of each edge $e$. 

In other words, we're attempting to assign lengths $y_e$ which minimize the total cost of crossing over to $t$. Since we know that $z = \max \sum f_P = \min \sum_{e} u_e y_e$, we know that minimizing the lengths will be equal to the value of the min-cut, by LP duality. If we assign lengths of 1 over all edges that cross the minimum $S$, $T$ cut, then we can be assured that $\sum f_P = \sum_{e} u_e y_e$ if we set all other edge lengths to 0. Thus, the dual of this problem is to find the minimum $S$,$T$ cut and assign edges lengths of 1 to all edges crossing the cut. 
\end{sol}

\newpage
\makenewtitle

\begin{prob}{2-a}
Explain why this captures the minimum mean cycle problem.
\end{prob}
\begin{sol}
First, we know that $f_{ij}$ represents a circulation. We see that $f_{ij}$ is constrained to be non-negative by the fact that $f_{ij} \geq 0$. Moreover, we know that the flow across the entire graph must be equal to 1 because $\sum_{i,j} f_{ij} = 1$. 

Now, we want to minimize $\sum c_{ij} f_{ij}$, which means that for each edge $(i,j)$, we want to minimize $c_{ij} f_{ij}$. Suppose for the sake of contradiction that when we decompose $\{ f_{ij} \}$ into cycles that there is some cycle $cp$ which is not a minimum mean cycle. Let us say it is of length $l$ and of cost $c$. Suppose the minimum mean cycle is of length $l^*$ and cost $c^*$. Then we know that $c/l > c^*/l^*$. We also know that the cycle $cp$ contribute $c f / l$ to the objective function, where $f$ is the circulation flowing through the cycle $cp$. 

However, if we replace the cycle $cp$ with the minimum mean cycle, then we can contributed $c^* f / l^*$ to the objective function. Notice that $c^* f / l^* < c f/l $, which means that our previous objective function was not minimal. This is a contradiction, so the circulation must go over minimum mean cycles.  
\end{sol}

\begin{prob}{2-b}
Give the dual of this linear program--it will involve maximizing a variable $\lambda$.
\end{prob}
\begin{sol}
Let us create a variable $\lambda$ which corresponds to the constraint $\sum_{i,j} f_{ij} = 1$. Since we have equality here, we know that $\lambda$ will be unbounded in sign. Let us create a set of variables $y_{i}$ which will correspond to the constraints $\sum_{j} f_{ij} - f_{ji} = 0$, one for each vertex $i$. 

Based on the primal's objective function, we see that the new constraints in the dual will be given by $\lambda + y_i - y_j \leq c_{ij}$. Moreover, by the constraint matrix for the dual, we know that we want to maximize $\lambda$. Thus, we obtain the following problem:

\begin{eqnarray}
\max \lambda \\
\text{s.t.} \hspace{1cm} \lambda + y_i - y_j \leq c_{ij}
\end{eqnarray}

Where $\lambda$ and each of the $y_i$ are unbounded in sign, and each of the constraints are set for all $i,j$. 
\end{sol}

\begin{prob}{2-c}
Give an explanation (in terms of min-cost-flow reduced costs) for why this dual formulation also captures minimum mean cycles. (Hint: how much is added to the cost of a $k$-edge cycle).
\end{prob}

\begin{sol}
If we rewrite the constraint $\lambda + y_i - y_j \leq c_{ij}$, we find that $\lambda \leq y_j + c_{ij} - y_i$. We know that $c_{ij}$ are costs, and therefore, we can think of $\lambda$ as the reduced cost, since we can think of $y_i$ as a price function defined at each vertex $i$.

This means that we can define a valid price function $y_i$ where all reduced costs are positive (if the solution to the dual is optimal). Moreover, we know that if $\lambda$ is optimal, then we must have $0 = c_{ij} - \lambda + y_j - y_i$ for some cycle, since otherwise we could make $\lambda$ marginally larger and obtain a better objective function while still satisfying the constraints.    

This means that for some cycle $K$, we have $\sum_{(i,j) \in K} c_{ij} - \lambda + y_i - y_j = 0$, which simplifies to $\sum_{(i,j) \in K} c_{ij} - \lambda = 0$ by telescoping. Therefore, we see that:
\begin{eqnarray}
\sum_{(i,j) \in C} c_{ij} = l \lambda
\end{eqnarray}

Where $l$ is the length of the cycle. Now, let us set $c$ to the total cost of the cycle, so that we know $c = \sum_{(i,j) \in C} c_{ij}$. Thus, we see that $c/l = \lambda$ is minimized, or in other words, we find a minimum mean cost cycle.
\end{sol}

\begin{prob}{2-d}
Let's assume the costs $c_{ij}$ are integers. Suggest a combinatorial algorithm (not based on linear programming) that uses binary search to find the right $\lambda$ to solve the dual problem. Can you use this to find a minimum mean cycle? Note: to know when you can terminate the search, you will need to lower bound the difference between the smallest and the next smallest mean cost of a cycle.
\end{prob}

\begin{sol}
First, we know that $\lambda \in [0, c_{max}]$ where $c_{max}$ is the maximum cost for any edge in the graph. This follows since we know that $(c_{ij} - \lambda) + y_i - y_j = 0$, so that we must have $c_{ij} \geq \lambda$. This means that we can perform a binary search for $\lambda$ inside of the interval $[0, c_{max}]$. 

We search by taking examining the interval $[a,b]$ and taking $(b-a)/2$. Once we have a candidate for $\lambda = (b-a)/2$, then we can check if this is feasible. Feasibility is checked by looking for a negative-cost cycle using the reduced edge costs with $\lambda = (b-a)/2$. We can augment the graph with this new $\lambda$, then check for negative-cost cycles by using Bellman-Ford. If we find a negative reduced cost cycle, then we must check for $\lambda$ which are smaller, so we recurse on the interval $[a, (b-a)/2]$. If there are no negative reduced cost cycles, then we can increase $\lambda$ while still being feasible, so we recurse on the interval $[(b-a)/2, b]$. 

We stop recursing when we have $b - a < \frac{1}{n^2}$, where $n$ is the total number of vertices in the graph. This follows because each cycle can consist of at most $n$ vertices each. We simply need to find a lower bound on the difference between the smallest and the second smallest mean cost of a cycle. However, we know that the mean costs $c_1 l_1 / k_1$ and $c_2 l_2 / k_2$ will have a difference $c_1 l_1 k_2 - c_2 l_2 k_1 >= 1$, since both of these values are integers. This implies that the mean costs differ by at least $\frac{1}{k_1 k_2} \geq \frac{1}{n^2}$. 

This means that we can be sure that we are done recursing when $b-a$ comes within $\frac{1}{n^2}$. This is because, by the integrality of costs, we are assured that $c_1 l_1 k_2 - c_2 l_2 k_1$ is an integer, and so we can bound the difference between the smallest and second smallest mean costs by $\frac{1}{n^2}$. Therefore, we can terminate the search when this occurs. 

We can then go and find the minimum mean cycle by using $\lambda$ in the reduced costs, then we can simply look for the minimum mean cost cycles by looking for zero edge weight cycles, which can be found by using a simple BFS.
\end{sol}

\newpage
\makenewtitle

\begin{prob}{3-a}
Argue that any LP optimization problem can be transformed into the form $min 0 \dot x$ subject to $Ax = b$, $x \geq 0$. This LP has optimum $0$ if it is feasible and $\infty$ if no. 
\end{prob}
\begin{sol}
We know that every LP optimization problem can be expressed in standard form. Therefore, we have the problem $\min cx$ such that $Ax = B, x\geq 0$. We derived in class that the dual of the standard form is $\max by$ such that $A^T y \geq c$. We $p$ be the solution of the primal and let $d$ be the solution of the dual. 

We know that in the optimal solution, we must have $p = d$, so we need to check whether $p = cx = by = d$, subject to all the conditions in both the primal and dual. Therefore, to check optimality, we look for feasibility of the following LP:
\begin{eqnarray}
by &=& cx \\
\text{ s.t. } Ax &=& b \\
x &\geq& 0 \\
Ay &\geq& c
\end{eqnarray}

Now, to find the optimum of either the primal or the dual, we just need to check feasibility of the above program. Finding a feasible solution will automatically give us an optimum solution by looking at the $p = by$ such that $by = cx$. Moreover, if either the primal or the dual is unbounded or infeasible, there will be no feasible solution to this LP. Notice that the feasibility of this program is equivalent to the minimization of $0 \dot x$, which is the objective function of the problem statement. If there are unbounded variables in the original primal, we can decompose $v = v^+ + v^-$ which represent the positive and negative portions of the unbounded variable. These can then enter into the variable set for the new LP.

Thus, we have created the problem $\min 0 \dot x$ subject to $Ax = b$ where $x \geq 0$, where we have transformed any standard form LP. 
\end{sol}

\newpage
\makenewtitle

\begin{prob}{4-a}
Given a standard form LP $min\{cx | Ax = b, x \geq 0 \}$, show how to define a different LP with an obvious feasible point, whose optima are precisely the feasible points of the original LP. 
\end{prob}
\begin{sol}

\end{sol}

\end{document}
